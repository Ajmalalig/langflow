import ThemedImage from "@theme/ThemedImage";
import useBaseUrl from "@docusaurus/useBaseUrl";
import ZoomableImage from "/src/theme/ZoomableImage.js";
import ReactPlayer from "react-player";
import Admonition from "@theme/Admonition";

# Memory Chatbot

This flow extends the [Basic Prompting](./basic-prompting) flow to include a chat memory. This makes the AI remember previous user inputs.

## Prerequisites

- [Langflow installed and running](../getting-started/install-langflow)
- [OpenAI API key created](https://platform.openai.com)

## Create the memory chatbot project

1. From the Langflow dashboard, click **New Project**.
2. Select **Memory Chatbot**.
3. The **Memory Chatbot** flow is created .

<ZoomableImage
  alt="Docusaurus themed image"
  sources={{
    light: "img/memory-chatbot.png",
    dark: "img/memory-chatbot.png",
  }}
  style={{
    width: "80%",
    margin: "20px auto",
    display: "flex",
    justifyContent: "center",
  }}
/>

This flow uses the same components as the Basic Prompting one, but extends it with a **Chat Memory** component. This component retrieves previous messages and sends them to the **Prompt** component to fill a part of the **Template** with context.

By clicking the template, you'll see the prompt editor like below:

<ZoomableImage
  alt="Docusaurus themed image"
  sources={{
    light: "img/memory-prompt.png",
    dark: "img/memory-prompt.png",
  }}
  style={{
    width: "80%",
    margin: "20px auto",
    display: "flex",
    justifyContent: "center",
  }}
/>

This gives the **OpenAI** component a memory of previous chat messages.

4. Don't forget to [set up your OpenAI API key](/starter-projects/basic-prompting#open-ai)

## Run

1. Open the Playground.
2. Type multiple questions. In the **Memories** tab, your queries are logged in order. Up to 100 queries are stored by default. Try telling the AI your name and asking `What is my name?`  on a second message, or `What is the first subject I asked you about?` to validate that previous knowledge is taking effect.

<Admonition type="tip">
  Check and adjust advanced parameters by opening the Advanced Settings of the **Chat Memory** component.

<ZoomableImage
  alt="Advanced Parameters"
  sources={{
    light: "img/advanced-parameters.png",
    dark: "img/advanced-parameters.png",
  }}
  style={{
    width: "80%",
    margin: "20px auto",
    display: "flex",
    justifyContent: "center",
  }}
/>
</Admonition>

## Session ID

`SessionID` is a unique identifier in Langflow that stores conversation sessions between the AI and a user. A `SessionID` is created when a conversation is initiated, and then associated with all subsequent messages during that session.

In the **Memory Chatbot** flow you created, the **Chat Memory** component references past interactions by **Session ID**. You can demonstrate this by modifying the **Session ID** value to switch between conversation histories.

1. In the **Session ID** field of the **Chat Memory** and **Chat Input** components, add a **Session ID** value like `MySessionID`.
2. Now, once you send a new message the **Playground**, you should have a new memory created on the **Memories** tab.
3. Notice how your conversation is being stored in different memory sessions.

<Admonition type="note" title="Note">
  Every **Chat Input** and **Chat Output** component comes with a `SessionID`.
  It defaults to the flow ID. Notice how setting them differently affects what
  the model remembers and play with **Chat Memory** settings.
</Admonition>

<Admonition type="tip">
  Create a **Global Variable** to store one or more `SessionID` so that you
  don't need to re-write them in every component.
</Admonition>
